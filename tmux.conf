# Change prefix to C-a
set -g prefix C-a
bind-key C-a send-prefix
unbind-key C-b

# Press C-a twice to switch to last window
bind-key C-a last-window

# Reload config on prefix+R
bind-key R source-file ~/.tmux.conf \; display-message "tmux.conf reloaded."

# Fix delay registering keys in programs running under tmux
set -sg escape-time 0

# Arrays start at 1
set -g base-index 1
setw -g pane-base-index 1

# Make sure programs know we're running tmux on a 256color terminal,
# set proper terminal-overrides for st
if-shell '[ "$TERM" = "st-256color" ]' \
    'set-option -g -a terminal-overrides '\'',*:Ss=\E[%p1%d q:Se=\E[2 q'\''' \
    'set-option -g default-terminal "xterm-256color"'

# Mousewheel scroll
set -g mouse on

# Vi mode
setw -g mode-keys vi

# Switch panes
bind-key -n C-Left select-pane -L
bind-key -n C-Right select-pane -R
bind-key -n C-Up select-pane -U
bind-key -n C-Down select-pane -D
#bind-key -n C-h select-pane -L
#bind-key -n C-l select-pane -R
#bind-key -n C-k select-pane -U
#bind-key -n C-j select-pane -D

# Switch windows
bind-key -n M-Left previous-window
bind-key -n M-Right next-window
bind-key -n M-h previous-window
bind-key -n M-l next-window

# Swap panes
bind-key -n S-Up swap-pane -U
bind-key -n S-Down swap-pane -D
bind-key -n S-k swap-pane -U
bind-key -n S-j swap-pane -D

# Swap windows
bind-key -n S-Left swap-window -d -t -1
bind-key -n S-Right swap-window -d -t +1
bind-key -n S-h swap-window -d -t -1
bind-key -n S-l swap-window -d -t +1

# Resize panes
bind-key -n C-S-Left resize-pane -L
bind-key -n C-S-Right resize-pane -R
bind-key -n C-S-Up resize-pane -U
bind-key -n C-S-Down resize-pane -D

# Sane copy-pasting
bind-key p paste-buffer
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X begin-selection\; send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

# Temporary cmus controller
bind-key n run-shell "tmux-run-fg cmus"

# Plugins
set-option -g @plugin 'tmux-plugins/tpm'
set-option -g @plugin 'arcticicestudio/nord-tmux'
set-option -g @plugin 'Morantron/tmux-fingers'
run-shell -b '~/.config/tmux/plugins/tpm/tpm'
